
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Annex: Tabular data analysis with pandas &#8212; PyPSA(-Eur) workshop November 2025</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'annex-pandas';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Annex: Intro to the basics of Python" href="annex-python.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">PyPSA(-Eur) workshop November 2025</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the workshop!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="annex-python.html">Annex: Intro to the basics of <code class="docutils literal notranslate"><span class="pre">Python</span></code></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Annex: Tabular data analysis with <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/resilient-project/pypsa-workshop-202511/blob/main/pypsa-workshop-202511/annex-pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/resilient-project/pypsa-workshop-202511" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/resilient-project/pypsa-workshop-202511/issues/new?title=Issue%20on%20page%20%2Fannex-pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/annex-pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Annex: Tabular data analysis with pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-data">Sorting Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">Filtering Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-values">Modifying Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series">Time Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby-functionality">Groupby Functionality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="annex-tabular-data-analysis-with-pandas">
<h1>Annex: Tabular data analysis with <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#annex-tabular-data-analysis-with-pandas" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have not yet set up Python on your computer, you can execute this tutorial in your browser via <a class="reference external" href="https://colab.research.google.com/">Google Colab</a>. Click on the rocket in the top right corner and launch “Colab”. If that doesn’t work download the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file and import it in <a class="reference external" href="https://colab.research.google.com/">Google Colab</a>.</p>
<p>Then install <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> by executing the following command in a Jupyter cell at the top of the notebook.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>!pip<span class="w"> </span>install<span class="w"> </span>-q<span class="w"> </span>pandas<span class="w"> </span>numpy
</pre></div>
</div>
</div>
<p><a class="reference external" href="http://pandas.pydata.org/">Pandas</a> is a an open source library providing tabular data structures and data analysis <a class="reference external" href="http://tools.In">tools.In</a> other words, if you can imagine the data in an Excel spreadsheet, then Pandas is the tool for the job.</p>
<img src="https://media.geeksforgeeks.org/wp-content/cdn-uploads/creating_dataframe1.png" width="720px" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Documentation for this package is available at <a class="reference external" href="https://pandas.pydata.org/docs/">https://pandas.pydata.org/docs/</a>.</p>
</div>
<section id="package-imports">
<h2>Package Imports<a class="headerlink" href="#package-imports" title="Link to this heading">#</a></h2>
<p>This will be our first experience with <em>importing</em> a package.</p>
<p>Usually we import <code class="docutils literal notranslate"><span class="pre">pandas</span></code> with the <em>alias</em> <code class="docutils literal notranslate"><span class="pre">pd</span></code>.</p>
<p>We might also need <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, Python’s main library for numerical computations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="series">
<h2>Series<a class="headerlink" href="#series" title="Link to this heading">#</a></h2>
<p>A Series represents a one-dimensional array of data. It is similar to a dictionary consisting of an <strong>index</strong> and <strong>values</strong>, but has more functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Example data on Germany’s final six nuclear power plants is from <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_power_stations_in_Germany#Nuclear">Wikipedia</a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Neckarwestheim&quot;</span><span class="p">,</span> <span class="s2">&quot;Isar 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Emsland&quot;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1269</span><span class="p">,</span> <span class="mi">1365</span><span class="p">,</span> <span class="mi">1290</span><span class="p">]</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neckarwestheim    1269
Isar 2            1365
Emsland           1290
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dictionary</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Neckarwestheim&quot;</span><span class="p">:</span> <span class="mi">1269</span><span class="p">,</span>
    <span class="s2">&quot;Isar 2&quot;</span><span class="p">:</span> <span class="mi">1365</span><span class="p">,</span>
    <span class="s2">&quot;Emsland&quot;</span><span class="p">:</span> <span class="mi">1290</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neckarwestheim    1269
Isar 2            1365
Emsland           1290
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Arithmetic operations can be applied to the whole <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">**</span><span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neckarwestheim    35.623026
Isar 2            36.945906
Emsland           35.916570
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can access the underlying index object if we need to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Neckarwestheim&#39;, &#39;Isar 2&#39;, &#39;Emsland&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can get values back out using the index via the <code class="docutils literal notranslate"><span class="pre">.loc</span></code> attribute</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Isar 2&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(1365)
</pre></div>
</div>
</div>
</div>
<p>Or by raw position using <code class="docutils literal notranslate"><span class="pre">.iloc</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(1290)
</pre></div>
</div>
</div>
</div>
<p>We can pass a list or array to loc to get multiple rows back:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;Neckarwestheim&quot;</span><span class="p">,</span> <span class="s2">&quot;Emsland&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neckarwestheim    1269
Emsland           1290
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataframe">
<h2>DataFrame<a class="headerlink" href="#dataframe" title="Link to this heading">#</a></h2>
<p>Series are limited to a single <strong>column</strong>. A more useful Pandas data structure is the <strong>DataFrame</strong>. A DataFrame is basically a bunch of series that share the same index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1269</span><span class="p">,</span> <span class="mi">1365</span><span class="p">,</span> <span class="mi">1290</span><span class="p">],</span>  <span class="c1"># MW</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PWR&quot;</span><span class="p">,</span> <span class="s2">&quot;PWR&quot;</span><span class="p">,</span> <span class="s2">&quot;PWR&quot;</span><span class="p">],</span>
    <span class="s2">&quot;start_year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1989</span><span class="p">,</span> <span class="mi">1988</span><span class="p">,</span> <span class="mi">1988</span><span class="p">],</span>
    <span class="s2">&quot;end_year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Neckarwestheim&quot;</span><span class="p">,</span> <span class="s2">&quot;Isar 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Emsland&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A wide range of statistical functions are available on both Series and DataFrames.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>capacity      1269
type           PWR
start_year    1988
end_year       NaN
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>capacity      1308.000000
start_year    1988.333333
end_year              NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can get a single column as a Series using python’s getitem syntax on the DataFrame object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neckarwestheim    1269
Isar 2            1365
Emsland           1290
Name: capacity, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Indexing works very similar to series</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Emsland&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>capacity      1290
type           PWR
start_year    1988
end_year       NaN
Name: Emsland, dtype: object
</pre></div>
</div>
</div>
</div>
<p>But we can also specify the column(s) and row(s) we want to access</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Emsland&quot;</span><span class="p">,</span> <span class="s2">&quot;start_year&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(1988)
</pre></div>
</div>
</div>
</div>
<p>We can also add new columns to the DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;reduced_capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">capacity</span> <span class="o">*</span> <span class="mf">0.8</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>reduced_capacity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
      <td>NaN</td>
      <td>1015.2</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
      <td>1092.0</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
      <td>1032.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can also remove columns or rows from a DataFrame:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation needs to be an <strong>inplace</strong> operation to be permanent.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;reduced_capacity&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can also drop columns with only NaN values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or fill it up with default “fallback” data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">2023</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
      <td>2023.0</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>2023.0</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>2023.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="sorting-data">
<h2>Sorting Data<a class="headerlink" href="#sorting-data" title="Link to this heading">#</a></h2>
<p>We can also sort the entries in dataframes, e.g. alphabetically by index or numerically by column values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;capacity&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="filtering-data">
<h2>Filtering Data<a class="headerlink" href="#filtering-data" title="Link to this heading">#</a></h2>
<p>We can also filter a DataFrame using a boolean series obtained from a condition. This is very useful to build subsets of the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">capacity</span> <span class="o">&gt;</span> <span class="mi">1300</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neckarwestheim    False
Isar 2             True
Emsland           False
Name: capacity, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">capacity</span> <span class="o">&gt;</span> <span class="mi">1300</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can also combine multiple conditions, but we need to wrap the conditions with brackets!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">capacity</span> <span class="o">&gt;</span> <span class="mi">1300</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">start_year</span> <span class="o">&gt;=</span> <span class="mi">1988</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or we make <a class="reference external" href="https://en.wikipedia.org/wiki/SQL">SQL-like</a> queries:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;start_year == 1988&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">1300</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;start_year == 1988 and capacity &gt; @threshold&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Isar 2</th>
      <td>1365</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="modifying-values">
<h2>Modifying Values<a class="headerlink" href="#modifying-values" title="Link to this heading">#</a></h2>
<p>In many cases, we want to modify values in a dataframe based on some rule. To modify values, we need to use <code class="docutils literal notranslate"><span class="pre">.loc</span></code> or <code class="docutils literal notranslate"><span class="pre">.iloc</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Isar 2&quot;</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1366</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1366</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sometimes it can be useful to rename columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;reactor&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>reactor</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>PWR</td>
      <td>1989</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1366</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>PWR</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sometimes it can be useful to replace values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;PWR&quot;</span><span class="p">:</span> <span class="s2">&quot;Pressurized water reactor&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity</th>
      <th>type</th>
      <th>start_year</th>
      <th>end_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Neckarwestheim</th>
      <td>1269</td>
      <td>Pressurized water reactor</td>
      <td>1989</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Isar 2</th>
      <td>1366</td>
      <td>Pressurized water reactor</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Emsland</th>
      <td>1290</td>
      <td>Pressurized water reactor</td>
      <td>1988</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="time-series">
<h2>Time Series<a class="headerlink" href="#time-series" title="Link to this heading">#</a></h2>
<p>Time indexes are great when handling time-dependent data.</p>
<p>Let’s first read some time series data, using the <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> function, which takes a local file path ora link to an online resource.</p>
<p>The example data hourly time series for Germany in 2015 for:</p>
<ol class="arabic simple">
<li><p>electricity demand from <a class="reference external" href="https://open-power-system-data.org/">OPSD</a> in GW</p></li>
<li><p>onshore wind capacity factors from <a class="reference external" href="https://www.renewables.ninja/">renewables.ninja</a> in per-unit of installed capacity</p></li>
<li><p>offshore wind capacity factors from <a class="reference external" href="https://www.renewables.ninja/">renewables.ninja</a> in per-unit of installed capacity</p></li>
<li><p>solar PV capacity factors from <a class="reference external" href="https://www.renewables.ninja/">renewables.ninja</a> in per-unit of installed capacity</p></li>
<li><p>electricity day-ahead spot market prices in €/MWh from EPEX Spot zone DE/AT/LU retrieved via <a class="reference external" href="https://www.smard.de/home">SMARD platform</a></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;https://tubcloud.tu-berlin.de/s/pKttFadrbTKSJKF/download/time-series-lecture-2.csv&quot;</span>
<span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>load</th>
      <th>onwind</th>
      <th>offwind</th>
      <th>solar</th>
      <th>prices</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-01 00:00:00</th>
      <td>41.151</td>
      <td>0.1566</td>
      <td>0.7030</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-01-01 01:00:00</th>
      <td>40.135</td>
      <td>0.1659</td>
      <td>0.6875</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-01-01 02:00:00</th>
      <td>39.106</td>
      <td>0.1746</td>
      <td>0.6535</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-01-01 03:00:00</th>
      <td>38.765</td>
      <td>0.1745</td>
      <td>0.6803</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-01-01 04:00:00</th>
      <td>38.941</td>
      <td>0.1826</td>
      <td>0.7272</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use Python’s <em>slicing</em> notation inside <code class="docutils literal notranslate"><span class="pre">.loc</span></code> to select a date range, and then use the built-in plotting feature of Pandas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2015-01-01&quot;</span><span class="p">:</span><span class="s2">&quot;2015-03-01&quot;</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/aeadd909e59be9bc719141098653ca75ae4fd38af6255d06b09c3f191033c7e5.png" src="_images/aeadd909e59be9bc719141098653ca75ae4fd38af6255d06b09c3f191033c7e5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2015-05-01&quot;</span><span class="p">,</span> <span class="s2">&quot;solar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/bc19bc27d2d8bc954f5f97e616d03ea26f837750cea683601bee2edfd35edac0.png" src="_images/bc19bc27d2d8bc954f5f97e616d03ea26f837750cea683601bee2edfd35edac0.png" />
</div>
</div>
<p>A common operation is to change the resolution of a dataset by resampling in time, which Pandas exposes through the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html#resampling">resample</a> function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The resample periods are specified using pandas <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases">offset index</a> syntax.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="p">[</span><span class="s2">&quot;onwind&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;ME&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/f30374a4e8d63f31aee25c3baf27a9763e2c7dfd2d5ee913363389dde12cbebb.png" src="_images/f30374a4e8d63f31aee25c3baf27a9763e2c7dfd2d5ee913363389dde12cbebb.png" />
</div>
</div>
</section>
<section id="groupby-functionality">
<h2>Groupby Functionality<a class="headerlink" href="#groupby-functionality" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects have a <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method. The simplest way to think about it is that you pass another series, whose values are used to split the original object into different groups.</p>
<p>Here’s an example which retrieves the total generation capacity per country:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fn</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/PyPSA/powerplantmatching/master/powerplants.csv&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Fueltype</th>
      <th>Technology</th>
      <th>Set</th>
      <th>Country</th>
      <th>Capacity</th>
      <th>Efficiency</th>
      <th>DateIn</th>
      <th>DateRetrofit</th>
      <th>DateOut</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kernkraftwerk Emsland</td>
      <td>Nuclear</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Germany</td>
      <td>1336.0</td>
      <td>0.33</td>
      <td>1988.0</td>
      <td>1988.0</td>
      <td>2023.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Brokdorf</td>
      <td>Nuclear</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Germany</td>
      <td>1410.0</td>
      <td>0.33</td>
      <td>1986.0</td>
      <td>1986.0</td>
      <td>2021.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Borssele</td>
      <td>Hard Coal</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Netherlands</td>
      <td>485.0</td>
      <td>NaN</td>
      <td>1973.0</td>
      <td>NaN</td>
      <td>2034.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Gemeinschaftskernkraftwerk Neckarwestheim</td>
      <td>Nuclear</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Germany</td>
      <td>1310.0</td>
      <td>0.33</td>
      <td>1976.0</td>
      <td>1989.0</td>
      <td>2023.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Isar</td>
      <td>Nuclear</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Germany</td>
      <td>1410.0</td>
      <td>0.33</td>
      <td>1979.0</td>
      <td>1988.0</td>
      <td>2023.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Country&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Capacity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Country
Albania                    2370.400000
Austria                   24643.200368
Belgium                   21443.151009
Bosnia and Herzegovina     4827.195964
Bulgaria                  15699.186363
Name: Capacity, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Let’s break apart this operation a bit. The workflow with <code class="docutils literal notranslate"><span class="pre">groupby</span></code> can be divided into three general steps:</p>
<ol class="arabic simple">
<li><p><strong>Split</strong>: Partition the data into different groups based on some criterion.</p></li>
<li><p><strong>Apply</strong>: Do some caclulation within each group, e.g. minimum, maximum, sums.</p></li>
<li><p><strong>Combine</strong>: Put the results back together into a single object.</p></li>
</ol>
<img src="https://miro.medium.com/max/1840/1*JbF6nhrQsn4f-TaSF6IR9g.png" width="720px" /><p>Grouping is not only possible on a single columns, but also on multiple columns. For instance,
we might want to group the capacities by country <strong>and</strong> fuel type. To achieve this, we pass a list of functions to the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">capacities</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Country&quot;</span><span class="p">,</span> <span class="s2">&quot;Fueltype&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">Capacity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">capacities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Country         Fueltype     
Albania         Hydro             1743.9
                Other               98.0
                Solar              294.5
                Wind               234.0
Austria         Hard Coal         1331.4
                                  ...   
United Kingdom  Other               55.0
                Solar            11668.6
                Solid Biomass     4919.0
                Waste              288.9
                Wind             38670.3
Name: Capacity, Length: 242, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>By grouping by multiple attributes, our index becomes a <code class="docutils literal notranslate"><span class="pre">pd.MultiIndex</span></code> (a hierarchical index with multiple <em>levels</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">capacities</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;Albania&#39;,     &#39;Hydro&#39;),
            (&#39;Albania&#39;,     &#39;Other&#39;),
            (&#39;Albania&#39;,     &#39;Solar&#39;),
            (&#39;Albania&#39;,      &#39;Wind&#39;),
            (&#39;Austria&#39;, &#39;Hard Coal&#39;)],
           names=[&#39;Country&#39;, &#39;Fueltype&#39;])
</pre></div>
</div>
</div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">.unstack</span></code> function to reshape the multi-indexed <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> into a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> which has the second index level as columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">capacities</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Country</th>
      <th>Spain</th>
      <th>Sweden</th>
      <th>Switzerland</th>
      <th>Ukraine</th>
      <th>United Kingdom</th>
    </tr>
    <tr>
      <th>Fueltype</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Biogas</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>Geothermal</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Hard Coal</th>
      <td>11904.878478</td>
      <td>291.000000</td>
      <td>NaN</td>
      <td>24474.0</td>
      <td>33823.617061</td>
    </tr>
    <tr>
      <th>Hydro</th>
      <td>26069.861248</td>
      <td>14273.686625</td>
      <td>20115.0408</td>
      <td>6590.0</td>
      <td>4576.175000</td>
    </tr>
    <tr>
      <th>Lignite</th>
      <td>1831.400000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Natural Gas</th>
      <td>28394.244000</td>
      <td>2358.000000</td>
      <td>55.0000</td>
      <td>4687.9</td>
      <td>36366.400000</td>
    </tr>
    <tr>
      <th>Nuclear</th>
      <td>7733.200000</td>
      <td>9859.000000</td>
      <td>3355.0000</td>
      <td>17635.0</td>
      <td>19181.000000</td>
    </tr>
    <tr>
      <th>Oil</th>
      <td>1854.371000</td>
      <td>1685.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>Other</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>55.000000</td>
    </tr>
    <tr>
      <th>Solar</th>
      <td>36998.200000</td>
      <td>281.800000</td>
      <td>96.8000</td>
      <td>5628.7</td>
      <td>11668.600000</td>
    </tr>
    <tr>
      <th>Solid Biomass</th>
      <td>563.000000</td>
      <td>2432.600000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4919.000000</td>
    </tr>
    <tr>
      <th>Waste</th>
      <td>388.054000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288.900000</td>
    </tr>
    <tr>
      <th>Wind</th>
      <td>34371.650000</td>
      <td>16958.800000</td>
      <td>55.0000</td>
      <td>461.4</td>
      <td>38670.300000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p><strong>Task 1:</strong> Provide a list of unique fuel types included in the power plants dataset.</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Fueltype</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Nuclear&#39;, &#39;Hard Coal&#39;, &#39;Hydro&#39;, &#39;Lignite&#39;, &#39;Natural Gas&#39;, &#39;Oil&#39;,
       &#39;Solid Biomass&#39;, &#39;Wind&#39;, &#39;Solar&#39;, &#39;Other&#39;, &#39;Biogas&#39;, &#39;Waste&#39;,
       &#39;Geothermal&#39;], dtype=object)
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Task 2:</strong> Filter the dataset by power plants with the fuel type “Hard Coal”. How many hard coal power plants are there?</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coal</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Fueltype</span> <span class="o">==</span> <span class="s2">&quot;Hard Coal&quot;</span><span class="p">]</span>
<span class="n">coal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Fueltype</th>
      <th>Technology</th>
      <th>Set</th>
      <th>Country</th>
      <th>Capacity</th>
      <th>Efficiency</th>
      <th>DateIn</th>
      <th>DateRetrofit</th>
      <th>DateOut</th>
      <th>lat</th>
      <th>lon</th>
      <th>Duration</th>
      <th>Volume_Mm3</th>
      <th>DamHeight_m</th>
      <th>StorageCapacity_MWh</th>
      <th>EIC</th>
      <th>projectID</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Borssele</td>
      <td>Hard Coal</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Netherlands</td>
      <td>485.000000</td>
      <td>NaN</td>
      <td>1973.0</td>
      <td>NaN</td>
      <td>2034.0</td>
      <td>51.433200</td>
      <td>3.716000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{'49W000000000054X'}</td>
      <td>{'BEYONDCOAL': {'BEYOND-NL-2'}, 'ENTSOE': {'49...</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Didcot</td>
      <td>Hard Coal</td>
      <td>CCGT</td>
      <td>PP</td>
      <td>United Kingdom</td>
      <td>1490.000000</td>
      <td>0.550000</td>
      <td>1970.0</td>
      <td>1998.0</td>
      <td>2013.0</td>
      <td>51.622300</td>
      <td>-1.260800</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{'48WSTN0000DIDCBC'}</td>
      <td>{'BEYONDCOAL': {'BEYOND-UK-22'}, 'ENTSOE': {'4...</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Mellach</td>
      <td>Hard Coal</td>
      <td>Steam Turbine</td>
      <td>CHP</td>
      <td>Austria</td>
      <td>200.000000</td>
      <td>NaN</td>
      <td>1986.0</td>
      <td>1986.0</td>
      <td>2020.0</td>
      <td>46.911700</td>
      <td>15.488300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{'14W-WML-KW-----0'}</td>
      <td>{'BEYONDCOAL': {'BEYOND-AT-11'}, 'ENTSOE': {'1...</td>
    </tr>
    <tr>
      <th>150</th>
      <td>Emile Huchet</td>
      <td>Hard Coal</td>
      <td>CCGT</td>
      <td>PP</td>
      <td>France</td>
      <td>596.493211</td>
      <td>NaN</td>
      <td>1958.0</td>
      <td>2010.0</td>
      <td>2022.0</td>
      <td>49.152500</td>
      <td>6.698100</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{'17W100P100P0344D', '17W100P100P0345B'}</td>
      <td>{'BEYONDCOAL': {'BEYOND-FR-67'}, 'ENTSOE': {'1...</td>
    </tr>
    <tr>
      <th>151</th>
      <td>Amercoeur</td>
      <td>Hard Coal</td>
      <td>CCGT</td>
      <td>PP</td>
      <td>Belgium</td>
      <td>451.000000</td>
      <td>0.187765</td>
      <td>1968.0</td>
      <td>NaN</td>
      <td>2009.0</td>
      <td>50.431000</td>
      <td>4.395500</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{'22WAMERCO000010Y'}</td>
      <td>{'BEYONDCOAL': {'BEYOND-BE-27'}, 'ENTSOE': {'2...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>29779</th>
      <td>St</td>
      <td>Hard Coal</td>
      <td>NaN</td>
      <td>CHP</td>
      <td>Germany</td>
      <td>21.645000</td>
      <td>NaN</td>
      <td>1982.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.976593</td>
      <td>9.068953</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{nan}</td>
      <td>{'MASTR': {'MASTR-SEE971943692655'}}</td>
    </tr>
    <tr>
      <th>29804</th>
      <td>Uer</td>
      <td>Hard Coal</td>
      <td>NaN</td>
      <td>CHP</td>
      <td>Germany</td>
      <td>15.200000</td>
      <td>NaN</td>
      <td>1964.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>51.368132</td>
      <td>6.662350</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{nan}</td>
      <td>{'MASTR': {'MASTR-SEE988421065542'}}</td>
    </tr>
    <tr>
      <th>29813</th>
      <td>Walheim</td>
      <td>Hard Coal</td>
      <td>NaN</td>
      <td>PP</td>
      <td>Germany</td>
      <td>244.000000</td>
      <td>NaN</td>
      <td>1964.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.017585</td>
      <td>9.157690</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{nan, nan}</td>
      <td>{'MASTR': {'MASTR-SEE937157344278', 'MASTR-SEE...</td>
    </tr>
    <tr>
      <th>29830</th>
      <td>Wd Ffw</td>
      <td>Hard Coal</td>
      <td>NaN</td>
      <td>CHP</td>
      <td>Germany</td>
      <td>123.000000</td>
      <td>NaN</td>
      <td>1990.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>50.099000</td>
      <td>8.653000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{nan, nan}</td>
      <td>{'MASTR': {'MASTR-SEE915289541482', 'MASTR-SEE...</td>
    </tr>
    <tr>
      <th>29835</th>
      <td>West</td>
      <td>Hard Coal</td>
      <td>NaN</td>
      <td>CHP</td>
      <td>Germany</td>
      <td>277.000000</td>
      <td>NaN</td>
      <td>1985.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>52.442456</td>
      <td>10.762681</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{nan, nan}</td>
      <td>{'MASTR': {'MASTR-SEE917432813484', 'MASTR-SEE...</td>
    </tr>
  </tbody>
</table>
<p>332 rows × 18 columns</p>
</div></div></div>
</details>
</div>
<p><strong>Task 3:</strong> Identify the three largest coal power plants. In which countries are they located? When were they built?</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coal</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">coal</span><span class="o">.</span><span class="n">Capacity</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Fueltype</th>
      <th>Technology</th>
      <th>Set</th>
      <th>Country</th>
      <th>Capacity</th>
      <th>Efficiency</th>
      <th>DateIn</th>
      <th>DateRetrofit</th>
      <th>DateOut</th>
      <th>lat</th>
      <th>lon</th>
      <th>Duration</th>
      <th>Volume_Mm3</th>
      <th>DamHeight_m</th>
      <th>StorageCapacity_MWh</th>
      <th>EIC</th>
      <th>projectID</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>194</th>
      <td>Kozienice</td>
      <td>Hard Coal</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Poland</td>
      <td>3682.216205</td>
      <td>NaN</td>
      <td>1972.0</td>
      <td>NaN</td>
      <td>2042.0</td>
      <td>51.6647</td>
      <td>21.4667</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{'19W000000000104I', '19W000000000095U'}</td>
      <td>{'BEYONDCOAL': {'BEYOND-PL-96'}, 'ENTSOE': {'1...</td>
    </tr>
    <tr>
      <th>3652</th>
      <td>Vuglegirska</td>
      <td>Hard Coal</td>
      <td>CCGT</td>
      <td>PP</td>
      <td>Ukraine</td>
      <td>3600.000000</td>
      <td>NaN</td>
      <td>1972.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.4652</td>
      <td>38.2027</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{nan}</td>
      <td>{'GPD': {'WRI1005107'}, 'GEO': {'GEO-43001'}}</td>
    </tr>
    <tr>
      <th>767</th>
      <td>Opole</td>
      <td>Hard Coal</td>
      <td>Steam Turbine</td>
      <td>PP</td>
      <td>Poland</td>
      <td>3071.893939</td>
      <td>NaN</td>
      <td>1993.0</td>
      <td>NaN</td>
      <td>2020.0</td>
      <td>50.7518</td>
      <td>17.8820</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>{'19W0000000001292'}</td>
      <td>{'BEYONDCOAL': {'BEYOND-PL-16'}, 'ENTSOE': {'1...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<p><strong>Task 4:</strong> What is the average “DateIn” of each “Fueltype”? Which type of power plants is the oldest on average?</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2024</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Fueltype&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">DateIn</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fueltype
Hard Coal        52.092593
Hydro            51.232471
Nuclear          48.214953
Lignite          47.184211
Other            31.543103
Waste            26.845588
Geothermal       23.857143
Oil              23.410138
Solid Biomass    22.516588
Natural Gas      22.081505
Wind             14.483789
Biogas           11.415730
Solar             8.584491
Name: DateIn, dtype: float64
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Task 5:</strong> In the time series provided, calculate the annual average capacity factors of wind and solar.</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>load       54.736992
onwind      0.205556
offwind     0.362993
solar       0.122621
prices     31.835717
dtype: float64
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Task 6:</strong> In the time series provided, calculate and plot the monthly average electricity price.</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="p">[</span><span class="s2">&quot;prices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;ME&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/37367db8fe3135854cb76d0a1e60ff543a81c746b48ed8ad616b068aa39d4814.png" src="_images/37367db8fe3135854cb76d0a1e60ff543a81c746b48ed8ad616b068aa39d4814.png" />
</div>
</details>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ""
        },
        kernelOptions: {
            name: "",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = ''</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="annex-python.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Annex: Intro to the basics of <code class="docutils literal notranslate"><span class="pre">Python</span></code></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-data">Sorting Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">Filtering Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-values">Modifying Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series">Time Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby-functionality">Groupby Functionality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Markus Millinger, Fabian Neumann, Iegor Riepin
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>